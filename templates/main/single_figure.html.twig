<!DOCTYPE html>
<html lang="fr">
<head>
    {% block head %}
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="Wiki de tricks de snowboard" />
        <meta name="author" content="Etienne Juffard" />
        <link rel="icon" type="image/x-icon" href="" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
        <title>{% block title %}Bienvenu sur le site SnowTricks{% endblock %}</title>
        {% block stylesheets %}
            <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
            <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,400&display=swap" rel="stylesheet"><link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"/>
            <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>

            <link href="{{ asset('bootstrap/front/style.css') }}" rel="stylesheet"/>
            <link href="{{ asset('style/main.min.css') }}" rel="stylesheet">
        {% endblock %}
    {% endblock %}
</head>
<body>

{% block header %}
    {% for c in couv %}
        <header id="header" class="fixed-top header-transparent">
            <div class="container d-flex align-items-center">

                <div class="logo mr-auto">
                    <h1 class="text-light"><a href="/"><span><i class="fas fa-mountain"></i> SnowTricks</span></a></h1>
                </div>

                {% block nav %}
                    <nav class="nav-menu d-none d-lg-block">
                        <ul>
                            <li class="active"><a href="/">Accueil</a></li>
                            <li><a href="/">Figures</a></li>
                            {% if(app.user == null) %}
                                <li><a href="/addUser">Inscription</a></li>
                                <li><a href="/login">Connexion</a></li>
                            {% else %}
                                <li><a href="/">{{ app.user.username }}</a></li>
                                <li><a href="/logout">Deconnexion</a></li>
                            {% endif %}
                        </ul>
                    </nav>
                {% endblock %}
            </div>
        </header>
    {% endfor %}
{% endblock %}

{% block hero %}
    <section id="hero">
        <div class="hero-container" data-aos="fade-up">
            <h1>{{ title }}</h1>
            <h2>{{ sub }}</h2>
            <a href="#about" class="btn-get-started scrollto"><i class="bx bx-chevrons-down"></i></a>
        </div>
    </section>
{% endblock %}

{% block content %}

<main id="main">
    {% for message in app.flashes('success') %}
        <div class="alert alert-success">
            {{ message }}
        </div>
    {% endfor %}

    <section id="services" class="services">
        <div class="container">

            <div class="section-title" data-aos="fade-in" data-aos-delay="100">
                <h2>Le {{ post.title }}</h2>
                <div class="row row-figure">
                    <p>{{ post.content }}</p>
                    {% if post.editionDate %}
                        <p>Mis à jour le {{ post.editionDate | date("d/m/Y") }}</p>
                    {% else %}
                        <p>Créé le {{ post.creationDate | date("d/m/Y") }} </p>
                    {% endif %}

                    {#<div class="row">
                        {% for m in media %}
                            {% if m.ressource.type == 1 %}
                                    <img src="{{ asset('/upload/' ~  m.link ) }}" class="img-fluid"/>
                            {% elseif m.ressource.type == 2 %}
                                    <iframe width="400" height="250" src="{{ m.link }}" class="img-fluid"></iframe>
                            {% endif %}
                        {% endfor %}
                    </div>#}
                </div>
            </div>

            <div class="row">
            </div>
        </div>
    </section>
    <section class="portfolio-details">
        <div class="container">
            <div class="portfolio-details-container">
                <div class="owl-carousel portfolio-details-carousel">
                    {% for m in media %}
                        {% if m.ressource.type == 1 %}
                            <img src="{{ asset('/upload/' ~  m.link ) }}" class="img-fluid"/>
                        {% elseif m.ressource.type == 2 %}
                            <iframe width="400" height="250" src="{{ m.link }}" class="img-fluid"></iframe>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
        <a class="btn btn-primary" href="/update_figure/{{ post.Slug }}">Editer</a>
    </section>
    <section class="comment-section">
        <div class="comments">
            <div class="container">
                <h4 class="comment-title">
                    Les derniers commentaires
                </h4>

                <button type="button" class="btn add-com" value="" id="add-com"><i class="fas fa-edit"></i> Ajouter un commentaire</button>

                <div class="comment_user_granted">
                    {% if app.user %}
                        <div class="form-comment">
                            {{ form_start(form, {'attr': {'novalidate': 'novalidate' }}) }}
                            <div class="row">
                                <div class="form-group group-content">
                                    {{ form_row(form.content) }}
                                </div>

                                <div class="form-group">
                                    {{ form_row(form.post_id, {'value': post.id}) }}
                                </div>

                                <div class="form-group">
                                    {{ form_row(form.user_id, {'value': app.user.id}) }}
                                </div>

                                <button type="submit" class="btn btn-primary">Commenter</button>
                            </div>
                            {{ form_end(form) }}
                        </div>
                    {% else %}
                        <p>Vous devez être connecté pour ajouter un commentaire</p>
                        <a class="btn btn-success" href="/login">Se connecter</a>
                    {% endif %}
                </div>

                <div class="comment-post">
                    {% for comment in comments %}

                        <div class="comment-container">

                            <div class="com-title">
                                {{ comment.content }}
                            </div>

                            <p class="pseudo">
                                Ajouté par {{ comment.user.username }}
                                Le {{ comment.creationDate|date("d/m/Y") }}
                            </p>
                        </div>

                    {% endfor %}

                    <nav aria-label="...">
                        <ul class="pagination">
                            {% for p in 1..pages['page'] %}
                                {% if(p == page) %}
                                    {% set active = 'active' %}
                                    {% else %}
                                        {% set active = '' %}
                                {% endif %}
                                <li class="page-item {{ active }}">
                                    <a class="page-link" href="/figure/{{ post.Slug }}/{{ p }}">{{ p }}</a>
                                </li>
                            {% endfor %}
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </section>
    {% endblock %}
    {% block footer %}
        <footer>
            <footer id="footer">
                <div class="footer-top">
                    <div class="container">
                        <div class="row">
                        </div>
                    </div>
                </div>

                <div class="container">
                    <div class="copyright">
                        &copy; Copyright <strong><span>Etienne Juffard {#{{ date('Y') }}#}</span></strong>. All Rights Reserved
                    </div>
                </div>
            </footer>
        </footer>
    {% endblock %}
    {% block javascripts %}
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
        <script src="{{ asset('js/main.js') }}" type="text/javascript"></script>
        <scrip src="{{ asset('bootstrap/front/main.js') }}" type="text/javascript"></scrip>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    {% endblock %}
</main>
</body>
</html>

{#
{% extends 'base.html.twig' %}

{% block title %} Le {{ post.title }} {% endblock %}

{% block header %}
    <header class="main_header">
        <div class="title-home">
            <div class="wrapper-title">
                <h1>Le {{ title }}</h1>
                <p>Catergorie : {{ sub }}</p>
            </div>
        </div>
        <div class="header-filter">
            <div class="filter"></div>
            {% for c in couv %}
                    <img src="{{ asset('/upload/' ~  c.link ) }}" class="header_img"/>
            {% endfor %}
        </div>
    </header>
{% endblock %}

        {% block content %}
            {% for message in app.flashes('success') %}
                <div class="alert alert-success">
                    {{ message }}
                </div>
            {% endfor %}
            <section class="container single_container">
                <article class="wrapper">
                    <div class="row row-single">
                        <div class="tricks">
                            <p>{{ post.title }}</p>
                            <p>{{ post.content }}</p>
                            {% if post.editionDate %}
                                <p>Mis à jour le {{ post.editionDate | date("d/m/Y") }}</p>
                            {% else %}
                                <p>Créé le {{ post.creationDate | date("d/m/Y") }}</p>
                            {% endif %}
                            <div class="media-container">
                                {% for m in media %}
                                    {% if m.ressource.type == 1 %}
                                        <div class="media-img">
                                            <img src="{{ asset('/upload/' ~  m.link ) }}"/>
                                        </div>
                                    {% elseif m.ressource.type == 2 %}
                                        <div class="media-vid">
                                            <iframe width="400" height="250" src="{{ m.link }}"></iframe>
                                        </div>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <a class="btn btn-primary" href="/update_figure/{{ post.Slug }}">Editer</a>

                    <div class="comments">

                        <div class="container">

                            <h4 class="comment-title">
                                Les derniers commentaires
                            </h4>
#}
{#                            #}
{#{% if session.error != '' %}#}{#
#}
{#
                                <div class="alert alert-danger" role="alert">
#}{#
#}
{#                                    {{ session.error }}#}{#
#}
{#
                                </div>
#}{#
#}
{#                            {% elseif session.success != '' %}#}{#
#}
{#
                                <div class="alert alert-success" role="alert">
#}{#
#}
{#                                    {{ session.success }}#}{#
#}
{#
                                </div>
#}{#
#}
{#                            {% endif %}#}{#


                            #}
{#<a href="" class="btn btn-primary add-com">
                                Ajouter un commentaire <i class="fas fa-edit"></i>
                            </a>#}{#

                            <button type="button" class="btn btn-primary add-com" value="" id="add-com">Ajouter un commentaire <i class="fas fa-edit"></i></button>

                            <div class="comment_user_granted">
                                {% if app.user %}
                                    <div class="form-comment">
                                        {{ form_start(form, {'attr': {'novalidate': 'novalidate' }}) }}
                                            <div class="form-group">
                                                Commentaire à ajouter
                                            </div>
                                            <div class="form-group">
                                                {{ form_row(form.content) }}
                                            </div>

                                            <div class="form-group">
                                                {{ form_row(form.post_id, {'value': post.id}) }}
                                            </div>

                                            <div class="form-group">
                                                {{ form_row(form.user_id, {'value': app.user.id}) }}
                                            </div>

                                        <button type="submit" class="btn btn-primary">Commenter</button>
                                        {{ form_end(form) }}
                                    </div>
                                    {% else %}
                                    <p>Vous devez être connecté pour ajouter un commentaire</p>
                                    <a class="btn btn-success" href="/login">Se connecter</a>
                                {% endif %}
                            </div>

                            {% for comment in comments %}

                                <div class="comment-container">

                                    <div class="com-title">
                                        {{ comment.content }}
                                    </div>

                                    <p class="pseudo">
                                        Ajouté par {{ comment.user.username }} <br>
                                        Le {{ comment.creationDate|date("d/m/Y") }}
                                    </p>
                                </div>

                            {% endfor %}

                        </div>
                    </div>

                </article>

            </section>
        {% endblock %}
#}
